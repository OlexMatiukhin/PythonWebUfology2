<!-- templates/blog/post_detail.html -->
{% extends 'users/base_user.html' %}
{% block css %}
    <link rel="stylesheet" href="/static/css/post_detail.css">
{% endblock %}
{% block content %}
<div class="container mt-4">
    <h2>{{ post.title }}</h2>
    <p><strong>ĞĞ²Ñ‚Ğ¾Ñ€:</strong> {{ post.author.username }}</p>
    <p><strong>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ:</strong> {{ post.category }}</p>
    <p>{{ post.content }}</p>
    {% if post.preview_image %}
        <img src="{{ post.preview_image.url }}" alt="preview" class="img-fluid mb-3">
    {% endif %}
 {% if user.is_authenticated %}
     <form action="{% url 'users:posts:toggle_post_like' post.id %}" class="like-form"  method="post" style="display:inline;">
     {% csrf_token %}
     <button type="submit" class="btn-outline-success">
            ğŸ‘ {{ post.likes.count }}
     </button>
     </form>


     <form action="{% url 'users:posts:toggle_post_dislike' post.id %}" method="post" class="dislike-form" style="display:inline;">
     {% csrf_token %}
     <button type="submit" class="btn-outline-danger">
            ğŸ‘ {{ post.dislikes.count }}
     </button>
     </form>
 {% else %}
    <p>ğŸ‘ {{ post.likes.count }} | ğŸ‘ {{ post.dislikes.count }}</p>
    <hr>
{% endif %}

    <h4>ĞšĞ¾Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ñ– ({{ comments.count }})</h4>
    {% for comment in comments %}
        <div class="border p-2 mb-2">
            <strong>{{ comment.author.username }}</strong>
            <small class="text-muted">{{ comment.created_at|date:"d.m.Y H:i" }}</small>

            <p>{{ comment.text }}</p>
            {% if user.is_authenticated %}
            <form action="{% url 'users:posts:toggle_comment_like' comment.id %}" method="post" class="like-form"  style="display:inline;">
     {% csrf_token %}
     <button type="submit" class="btn-outline-success">
            ğŸ‘ {{ comment.likes.count }}
     </button>
     </form>


     <form action="{% url 'users:posts:toggle_comment_dislike'  comment.id %}" method="post"  class="dislike-form" style="display:inline;">
     {% csrf_token %}
     <button type="submit" class="btn-outline-danger">
            ğŸ‘ {{ comment.dislikes.count }}
     </button>
     </form>
 {% else %}


            <p>ğŸ‘ {{ comment.likes.count }} | ğŸ‘ {{ comment.dislikes.count }}</p>
    <hr>
{% endif %}


        </div>
    {% empty %}
        <p>ĞĞµĞ¼Ğ°Ñ” ĞºĞ¾Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ñ–Ğ².</p>
    {% endfor %}
    <hr>

    {% if user.is_authenticated %}
        <h5>Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ ĞºĞ¾Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€:</h5>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">ĞĞ°Ğ´Ñ–ÑĞ»Ğ°Ñ‚Ğ¸</button>
        </form>
    {% else %}
        <p><a href="{% url 'users:login' %}">Ğ£Ğ²Ñ–Ğ¹Ğ´Ñ–Ñ‚ÑŒ</a>, Ñ‰Ğ¾Ğ± Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¸Ñ‚Ğ¸ ĞºĞ¾Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€.</p>
    {% endif %}
</div>
{% endblock %}
